const e={"Content-Type":"application/json"},t=e=>{const t=((e="")=>e.replace(/\/$/u,""))(e);return/^(https?:)?\/\//.test(t)?t:`https://${t}`},r=e=>{"AbortError"!==e.name&&console.error(e.message)},a=e=>e.dataset.path||e.getAttribute("id"),n=(e,t)=>{t.forEach(((t,r)=>{t.innerText=e[r].toString()}))},s=({serverURL:s,path:o=window.location.pathname,selector:l=".waline-pageview-count",update:p=!0,lang:i=navigator.language})=>{const g=new AbortController,h=Array.from(document.querySelectorAll(l)),c=e=>{const t=a(e);return null!==t&&o!==t},d=e=>(({serverURL:e,lang:t,paths:r,signal:a})=>(({serverURL:e,lang:t,paths:r,type:a,signal:n})=>fetch(`${e}/article?path=${encodeURIComponent(r.join(","))}&type=${encodeURIComponent(a.join(","))}&lang=${t}`,{signal:n}).then((e=>e.json())))({serverURL:e,lang:t,paths:r,type:["time"],signal:a}).then((e=>Array.isArray(e)?e:[e])))({serverURL:t(s),paths:e.map((e=>a(e)||o)),lang:i,signal:g.signal}).then((t=>n(t,e))).catch(r);if(p){const r=h.filter((e=>!c(e))),a=h.filter(c);(t=>(({serverURL:t,lang:r,path:a,type:n,action:s})=>fetch(`${t}/article?lang=${r}`,{method:"POST",headers:e,body:JSON.stringify({path:a,type:n,action:s})}).then((e=>e.json())))({...t,type:"time",action:"inc"}))({serverURL:t(s),path:o,lang:i}).then((e=>n(new Array(r.length).fill(e),r))),a.length&&d(a)}else d(h);return g.abort.bind(g)},o=()=>s({serverURL:{provider:"Giscus",lightTheme:"https://unpkg.com/vuepress-theme-hope@2.0.0-beta.238/templates/giscus/light.css",darkTheme:"https://unpkg.com/vuepress-theme-hope@2.0.0-beta.238/templates/giscus/dark.css",repo:"JsweetA/blogs",repoId:"R_kgDOKkAldA",category:"Ideas",categoryId:"DIC_kwDOKkAldM4CaZ3C"}.serverURL});export{o as updatePageview};
